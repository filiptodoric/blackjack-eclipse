<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Blackjack</title>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="../blackjack/deck.js"></script>
<script src="../blackjack/game.js"></script>
<script>


	var index = -1;
	var deck = getDeck();

	function deal() {
		index++
		return deck[index];
	}

	function change() {
		var card = deal();
		index++;
		$("#dealer-cards").html(card);
	}

	var player1_hand = new Array();
	player1_hand[0] = deal();
	player1_hand[1] = deal();
	display(player1_hand, "player1_hand");
	
	//Dealer hand
	var dealer_hand = new Array();
	dealer_hand[0] = deal();
	dealer_hand[1] = deal();
	
	function hit(hand) {
		hand[hand.length] = deal();
	}

	function score(hand) {
		var total = 0;
		var soft = 0;
		var value = 0; 
		for (i = 0; i < hand.length; i++) {
			value = hand[i];
			if (value == 1) {
				soft = soft + 1;
				total = total + 11;
			} 
			else {
				if (value == 11 || value == 12 || value == 13) {
					total = total + 10;
				} 
				else {
					total = total + value;
				}
			}
		}
		while (soft > 0 && total > 21) {
			total = total - 10; 
			soft = soft - 1;
		}
		return total;
	}

	function dealer(dealer_hand) {
		var hasAce = false;
		for (i = 0; i < dealer_hand.length; i++) {
			value = dealer_hand[i];
			if (value == 1) {
				hasAce = true;
			} 
		}
		console.dir(hasAce);
		if (score(dealer_hand) < 17) {
			console.dir("< 17");
			hit(dealer_hand);
		}
		if(score(dealer_hand) == 17 && hasAce == true)	{
			console.dir("== 17");
			hit(dealer_hand);
		}
		console.dir(dealer_hand);
		return score(dealer_hand);
	}
	
	
	
	function display(id, element)	{
		var str = "";
		for(var x = 0; x < id.length; x++)	{
			if(id[x] == 11)	{
				str += "Jack ";
			}
			if(id[x] == 12)	{
				str += "Queen ";
			}
			if(id[x] == 11)	{
				str += "King ";
			}
			if(id[x] == 1)	{
				str += "Ace ";
			}
			else{
				str += id[x] + " ";
			}
		}
		$("#" + element).html(str);
	}
	
</script>
<body>
<h1>Blackjack</h1>
  <div id="dealer">Dealer
  	<h3>Dealer Cards:</h3>
  	<button onclick="dealer(dealer_hand)">Dealer</button>
  	<div id="dealer-hand">
  		
  	</div>
  </div>
  <hr>
    <div id="player1">Dealer
  	<h3>Player 1 Cards:</h3>
  	<button onclick="hit(player1_hand)">Hit</button>
  	<button onclick="score(player1_hand)">Score</button>
  	<div id="player1_hand">
  		
  	</div>
  </div>
</body>
</html>